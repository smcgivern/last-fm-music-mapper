%h1
  %a{:href => r('/')} Last.fm music map
  for
  %a{:href => "http://last.fm/user/#{@username}"}= @username
:kramdown
  All done! You can see your music map below, generated with these settings:
  <code>username: #{@username}; period: #{@period[:name].downcase}</code>.

  Some artists might be missing countries. If you see one of them below, add a
  tag by clicking the link in the artist box and it will be picked up the next
  time the page is generated. The tag name needs to be either the country name
  ('Mali') or an adjective ('Malian').

  To add the [profile image](#{@image}) to your profile page, copy the contents
  of the box underneath this paragraph and put them in the About You section of
  your [Last.fm settings](http://www.last.fm/settings).
%p
  %textarea{:rows => 5, :cols => 70, :wrap => 'soft'}
    :preserve
      [url=#{a(@self)}][img]#{a(@image)}[/img][/url]
      (Username: [b]#{@username}[/b]; period: [b]#{@period[:name].downcase}[/b].)
      Generated by the [url=#{a('/')}]Last.fm music mapper[/url].
%object#map{:data => r('/image/world.svg'), :width => '100%',
            :type => 'image/svg+xml'}
%ol#artists
  - @user_artists.each do |artist|
    %li{:class => country_classes(artist[:countries])}
      %h3
        %a{:href => artist[:url]}
          %img{:src => artist[:image], :width => 64, :alt => ''}
        %a{:href => artist[:url]}
          = h(artist[:name])
      %p
        Plays:
        %span.playcount
          = h(artist[:playcount])
      %p
        From:
        - if artist[:countries].length > 0
          = sentence_join(country_names(artist[:countries]))
        - else
          = succeed '?' do
            %span.country-name.error nowhere
          = surround '(', ')' do
            %a{:href => "#{artist[:url]}/+tags",
               :title => "Tags for #{artist[:name]}"} Add a tag!
